---
description: 產生提交訊息與提交
allowed-tools: Bash, AskUserQuestion
---

<!--
使用方式:
  /do-git-commit

說明:
  此命令會自動分析 git 變更、產生提交訊息，並在獲得確認後執行提交。
-->

執行 git 提交流程：

1. 並行執行 `git status`, `git diff`, `git log --oneline -n 5` 收集變更資訊

2. 分析變更內容，生成提交訊息：
   - **提交訊息格式:**
     ```
     [主要訊息標題]（1-2 句話）

     變更摘要：
     - 檔案名稱 (變更說明)
     - 檔案名稱 (變更說明)
     ```
   - **主要訊息標題:**
     - 摘要變更性質：新功能（Add/Implement）、修正錯誤（Fix）、重構（Refactor）、文件更新（Update docs）、測試（Add tests）等
     - 重點描述「為何」而非「做了什麼」
     - 遵循專案現有的提交訊息風格
   - **變更摘要:**
     - 列出所有修改的檔案及其變更說明
     - 格式：`- 檔案名稱 (變更說明)`
     - 範例：`- main.py (新增模型配置參數)`

3. 使用 `AskUserQuestion` 工具向用戶展示草擬的完整提交訊息，提供選項：
   - 「同意並提交」
   - 「修改訊息」
   - 「取消」

4. 根據用戶選擇執行對應操作：
   - **同意並提交:** 使用草擬訊息執行 `git add . && git commit -m "$(cat <<'EOF'\n[草擬訊息]\nEOF\n)" && git status`
   - **修改訊息:** 使用用戶輸入的自訂訊息執行提交
   - **取消:** 輸出「提交已取消」，不執行任何 git 操作

5. 僅顯示最終提交結果（提交編號、訊息、檔案變更）

**回應要求:**
- 不輸出處理過程描述（「我將執行...」、「現在...」等）
- 直接執行工具，僅在請求確認和顯示結果時輸出
- 草擬訊息包含主要訊息標題和變更摘要，以簡潔格式呈現
- 最終結果以精簡格式輸出（提交編號、訊息、變更統計）

## 注意事項

- **不要推送到遠端:** 除非用戶明確要求，否則不執行 `git push`
- **安全性優先:** 在執行提交前必須獲得用戶明確確認
- **遵循專案風格:** 參考最近的提交記錄，保持訊息風格一致
- **避免空提交:** 如果沒有變更，不建立空提交
